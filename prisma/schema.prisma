generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// ==============================
// PERMISSÕES DO SISTEMA
// ==============================
enum Role {
  ADMIN
  USER
}

// ==============================
// USUÁRIOS
// ==============================
model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  role      Role     @default(USER)

  media     Media[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// ==============================
// CMS DINÂMICO PARA PÁGINAS
// ==============================
model ContentBlock {
  id          Int      @id @default(autoincrement())
  page        String
  key         String
  value       String?  @db.LongText
  type        String
  title       String?  
  description String?  

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}


// ==============================
// FORMULÁRIOS
// ==============================
model Formulario {
  id                  Int       @id @default(autoincrement())
  name                String
  email               String
  telefone            String?
  dataNascimento      DateTime?
  nomeResponsavel     String?
  telefoneResponsavel  String?
  nomeCredencial      String
  tamanhoCamiseta     String?
  autorizacaoImagem   String?
  alergiaRestricao    String?
  descricao           String?   @db.LongText

  imagens             Media[]   @relation("FormularioImages")

  createdAt           DateTime  @default(now())
  updatedAt           DateTime  @updatedAt
}


// ==============================
// EVENTOS
// ==============================
model Evento {
  id         Int      @id @default(autoincrement())
  titulo     String
  descricao  String?  @db.LongText
  dataInicio DateTime?
  dataFim    DateTime?
  imagem     String?  @db.LongText
  createdAt  DateTime @default(now())
}

// ==============================
// ARQUIVOS / UPLOADS
// ==============================
model Media {
  id           Int          @id @default(autoincrement())
  filename     String
  url          String
  mimeType     String?
  size         Int?
  uploadedAt   DateTime     @default(now())

  uploadedBy   Int?
  user         User?        @relation(fields: [uploadedBy], references: [id])

  formularioId Int?
  formulario   Formulario?  @relation("FormularioImages", fields: [formularioId], references: [id])
}

model Timeline {
  id         Int          @id @default(autoincrement())
  eventDate  DateTime
  milestones Milestone[]
}

model Milestone {
  id         Int       @id @default(autoincrement())
  title      String
  date       DateTime
  note       String?
  timelineId Int
  timeline   Timeline  @relation(fields: [timelineId], references: [id], onDelete: Cascade)
}

model Depoimento {
  id        Int      @id @default(autoincrement())
  texto String @db.LongText
  createdAt DateTime @default(now())
}

model CarouselItem {
  id        Int      @id @default(autoincrement())
  altText   String?
  image     Bytes     // ← novo campo para salvar o arquivo
  mimeType  String?   // tipo da imagem, ex: image/jpeg
  sortOrder Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}



